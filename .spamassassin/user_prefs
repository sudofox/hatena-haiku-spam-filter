# SpamAssassin user preferences file.  See 'perldoc Mail::SpamAssassin::Conf'
# for details of what can be tweaked.
#* 
#* Note: this file is not read by SpamAssassin until copied into the user
#* directory. At runtime, if a user has no preferences in their home directory
#* already, it will be copied for them, allowing them to perform personalised
#* customisation.  If you want to make changes to the site-wide defaults,
#* create a file in /etc/spamassassin or /etc/mail/spamassassin instead.
###########################################################################

# How many points before a mail is considered spam.
 required_score		5

# Whitelist and blacklist addresses are now file-glob-style patterns, so
# "friend@somewhere.com", "*@isp.com", or "*.domain.net" will all work.
# whitelist_from	someone@somewhere.com

# Add your own customised scores for some tests below.  The default scores are
# read from the installed spamassassin rules files, but you can override them
# here.  To see the list of tests and their default scores, go to
# http://spamassassin.apache.org/tests.html .
#
# score SYMBOLIC_TEST_NAME n.nn

# Speakers of Asian languages, like Chinese, Japanese and Korean, will almost
# definitely want to uncomment the following lines.  They will switch off some
# rules that detect 8-bit characters, which commonly trigger on mails using CJK
# character sets, or that assume a western-style charset is in use. 
# 

# uncommented for Hatena Haiku since there's lots of Japanese users
score HTML_COMMENT_8BITS	0
score UPPERCASE_25_50		0
score UPPERCASE_50_75		0
score UPPERCASE_75_100	0
score OBSCURED_EMAIL          0

# Speakers of any language that uses non-English, accented characters may wish
# to uncomment the following lines.   They turn off rules that fire on
# misformatted messages generated by common mail apps in contravention of the
# email RFCs.

score SUBJ_ILLEGAL_CHARS     	0

# Begin Sudofox config

include user_black_and_white_lists

score FROM_ILLEGAL_CHARS	0
score SUBJECT_NEEDS_ENCODING	0
# sports spam
score GAPPY_SUBJECT		3
score TVD_SPACE_RATIO		1
score TVD_SPACE_RATIO_MINFP	1
score LOTS_OF_MONEY		2
score BAYES_99			4
score BAYES_999			4
score ONLINE_PHARMACY		3
score TVD_VISIT_PHARMA		3

# We won't be using email-related spam checks 
# since this will be run against Hatena Haiku

score DNS_FROM_AHBL_RHSBL	0
score NO_DNS_FOR_FROM		0
score DKIM_ADSP_NXDOMAIN	0
score NO_RELAYS			0

# Retitle some of the rules to make more sense

describe	USER_IN_BLACKLIST	Hatena ID is blacklisted
describe	USER_IN_WHITELIST	Hatena ID is whitelisted
describe	HK_RANDOM_FROM		Hatena ID looks random
describe	FROM_LOCAL_NOVOWEL	Hatena ID has no vowels

# Custom stuff
#      ........................................................................

header		SUDO_HATENA_ZERO_FANS X-Hatena-Fan-Count =~ /^0$/
score		SUDO_HATENA_ZERO_FANS 1.0
describe	SUDO_HATENA_ZERO_FANS User has no fans

header		SUDO_HATENA_FEW_FANS X-Hatena-Fan-Count =~ /^([1-9]{1})$/
score		SUDO_HATENA_FEW_FANS -1.0
describe	SUDO_HATENA_FEW_FANS User has 1-9 fans - spam less likely

header		SUDO_HATENA_10_PLUS_FANS X-Hatena-Fan-Count =~ /^([0-9]{2})$/
score		SUDO_HATENA_10_PLUS_FANS -2.0
describe	SUDO_HATENA_10_PLUS_FANS User has 10-99 fans - spam unlikely

header		SUDO_HATENA_100_PLUS_FANS X-Hatena-Fan-Count =~ /^([0-9]{3,})$/
score		SUDO_HATENA_100_PLUS_FANS -10.0
describe	SUDO_HATENA_100_PLUS_FANS User has 100+ fans - prob legitimate

header		SUDO_HATENA_SPORTS_SPAM_1 Subject =~ /^http.*(boxing|stream|champions|playoffs|game|soccer|rugby|espn|watchfree|watch|finals)/
score		SUDO_HATENA_SPORTS_SPAM_1 3.0
describe	SUDO_HATENA_SPORTS_SPAM_1 Keyword - URL with sports/streaming-related terms

header          SUDO_HATENA_SPORTS_SPAM_2 Subect =~ /(boxing|stream|champions|playoffs|soccer|rugby|espn|watchfree|watch|finals)/i
score           SUDO_HATENA_SPORTS_SPAM_2 3.0
describe        SUDO_HATENA_SPORTS_SPAM_2 Keyword: sports/streaming-related terms

body            SUDO_HATENA_SPORTS_SPAM_3 /(boxing|stream|champions|playoffs|soccer|rugby|espn|watchfree|finals)/i
score           SUDO_HATENA_SPORTS_SPAM_3 2.0
describe        SUDO_HATENA_SPORTS_SPAM_3 Body: sports/streaming-related terms

body		SUDO_HATENA_SPORTS_SPAM_4 /http.*(boxing|champions|playoffs|soccer|rugby|espn|watchfree)/
score		SUDO_HATENA_SPORTS_SPAM_4 1.0
describe	SUDO_HATENA_SPORTS_SPAM_4 Body: URL with sports/streaming-related terms

header		SUDO_HATENA_SPORTS_SPAM_5 Subject =~ /.*(stream|watch|free|live|online|tream).*(\w+)\Wvs\W(\w+).*(watch|free|live|online|stream|tream|ream).*/i
score		SUDO_HATENA_SPORTS_SPAM_5 2.5
describe	SUDO_HATENA_SPORTS_SPAM_5 Subject: Sports spam

body		SUDO_HATENA_SPORTS_SPAM_6 /.*(stream|watch|free|live|online|tream).*(\w+)\Wvs\W(\w+).*(watch|free|live|online|stream|tream|ream).*/i
score		SUDO_HATENA_SPORTS_SPAM_6 2.0
describe	SUDO_HATENA_SPORTS_SPAM_6 Body: Sports spam

body		SUDO_HATENA_TV_SPAM_1 /(watch).*(full.movie|full.episode).*/i
score		SUDO_HATENA_TV_SPAM_1 2.0
describe	SUDO_HATENA_TV_SPAM_1 Body: Watch TV/movie for free

body            SUDO_HATENA_MOBGAME_SPAM_1 /((tips.and.cheats|cheats.and.tips)|((unlimited|infinite|[0-9]{4,}).(diamonds|coins|gems)))/i
score           SUDO_HATENA_MOBGAME_SPAM_1 2.0
describe        SUDO_HATENA_MOBGAME_SPAM_1 Body: mobile game cheats/hacks


#      ........................................................................

header		SUDO_HATENA_HTTP_KEYWORD Subject =~ /^http(s|).*/
score		SUDO_HATENA_HTTP_KEYWORD 1.5
describe	SUDO_HATENA_HTTP_KEYWORD Keyword is a URL

